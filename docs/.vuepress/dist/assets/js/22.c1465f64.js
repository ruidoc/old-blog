(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{377:function(v,_,t){"use strict";t.r(_);var s=t(44),a=Object(s.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h2",{attrs:{id:"tcp-与-udp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp-与-udp"}},[v._v("#")]),v._v(" TCP 与 UDP")]),v._v(" "),t("p",[v._v("计算机网络知识庞大而高深，我们就抓主要矛盾，讲重点。")]),v._v(" "),t("h3",{attrs:{id:"tcp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp"}},[v._v("#")]),v._v(" TCP")]),v._v(" "),t("p",[v._v("先说著名的三次握手与四次挥手")]),v._v(" "),t("h4",{attrs:{id:"三次握手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三次握手"}},[v._v("#")]),v._v(" 三次握手")]),v._v(" "),t("p",[v._v("这个过程有点像相亲开场白，如下：")]),v._v(" "),t("p",[t("img",{attrs:{src:"/assets/84D3FD24-1662-4012-B242-F68CBED1912E.png",alt:"84D3FD24-1662-4012-B242-F68CBED1912E"}})]),v._v(" "),t("p",[v._v("对应到实际的 TCP 连接建立过程，是这样的：")]),v._v(" "),t("p",[t("img",{attrs:{src:"/assets/14D876E3-34E3-4981-AE68-ACA62307D174.png",alt:"14D876E3-34E3-4981-AE68-ACA62307D174"}})]),v._v(" "),t("p",[v._v("解释下这里的 SYN 报文和 ACK 报文：")]),v._v(" "),t("ul",[t("li",[v._v("SYN 报文：起标识作用。当 "),t("strong",[v._v("SYN=1，ACK=0")]),v._v(" 时，表明这是一个连接请求报文。若对方同意连接，则相应报文是 "),t("strong",[v._v("SYN=1，ACK=1")])]),v._v(" "),t("li",[v._v("ACK 报文：TCP协议规定，只有ACK=1时网络有效。")])]),v._v(" "),t("p",[t("strong",[v._v("具体过程如下：")])]),v._v(" "),t("ol",[t("li",[v._v("客户端发出请求连接，报文是： SYN=1，ACK=0，seq=x。")]),v._v(" "),t("li",[v._v("服务端进行回复确认，报文是：SYN=1，ACK=1，还有服务端序号 seq=y, 确认号 ack=x+1。")]),v._v(" "),t("li",[v._v("客户端再次确认，这一步用不到 SYN 了，报文是：ACK=1, seq=x+1, ack=y+1。")])]),v._v(" "),t("h4",{attrs:{id:"为什么-tcp-一定要握手三次"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么-tcp-一定要握手三次"}},[v._v("#")]),v._v(" 为什么 TCP 一定要握手三次？")]),v._v(" "),t("p",[v._v("按照常理，一问一答就能建立联系了。")]),v._v(" "),t("ul",[t("li",[v._v("A 向 B 发出邀请")]),v._v(" "),t("li",[v._v("B 接受")])]),v._v(" "),t("p",[v._v("为什么 TCP 这就要三步呢？")]),v._v(" "),t("p",[v._v("客户端请求报文可能因为”"),t("strong",[v._v("网络状态")]),v._v("“原因延迟到达服务端。因为延迟，此时报文已失效，而服务端会认为这是一个新的连接请求，向客户端发出响应报文。")]),v._v(" "),t("p",[v._v("如果没有第三次握手，服务端响应后立即建立连接，则这个连接会一直没有数据收发，白白浪费资源。")]),v._v(" "),t("p",[v._v("而有了第三次握手，客户端发送 "),t("strong",[v._v("ACK=1")]),v._v("，则表示连接未失效。客户端收到，则建立起 TCP 连接。")]),v._v(" "),t("p",[v._v("后续数据交换 ACK 必须为1，保证报文不失效。")]),v._v(" "),t("p",[v._v("一句话总结："),t("strong",[v._v("避免和已失效的请求报文建立连接，从而产生错误")]),v._v("。")]),v._v(" "),t("h4",{attrs:{id:"四次挥手"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四次挥手"}},[v._v("#")]),v._v(" 四次挥手")]),v._v(" "),t("p",[t("img",{attrs:{src:"/assets/7EEE727A-11A1-45CE-B6ED-D5414DE2DFFA.png",alt:"7EEE727A-11A1-45CE-B6ED-D5414DE2DFFA"}})]),v._v(" "),t("p",[v._v("新的报文类型：FIN 报文。它表示数据传输完毕，请求释放连接。")]),v._v(" "),t("p",[t("strong",[v._v("具体过程如下：")])]),v._v(" "),t("ol",[t("li",[v._v("客户端提分手，抛出一个 FIN=1 的报文。")]),v._v(" "),t("li",[v._v("服务器气急，回复了 "),t("strong",[v._v("ACK=1")]),v._v(" 表示同意。")]),v._v(" "),t("li",[v._v("服务器不想被分手，于是也提出分手，FIN=1。")]),v._v(" "),t("li",[v._v("客户端求之不得，回复 "),t("strong",[v._v("ACK=1")]),v._v("。")])]),v._v(" "),t("p",[v._v("这个过程像极了情侣分手，哈哈。")]),v._v(" "),t("h4",{attrs:{id:"为什么tcp分手一定要挥手四次"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么tcp分手一定要挥手四次"}},[v._v("#")]),v._v(" 为什么TCP分手一定要挥手四次？")]),v._v(" "),t("p",[v._v("TCP连接是"),t("strong",[v._v("全双工协议")]),v._v("，双方可以同时向对方发送或接收数据。")]),v._v(" "),t("p",[v._v("所以客户端想断开连接，先要确定服务器是否有数据要发。")]),v._v(" "),t("p",[v._v("然后服务器回复可以断开。")]),v._v(" "),t("p",[v._v("这就是前两次的挥手：确认是否可以分手。")]),v._v(" "),t("p",[v._v("第三步：服务器发送 FIN 报文正式要分手。\n第四步：客户端同意，分手成功！")]),v._v(" "),t("h3",{attrs:{id:"tcp与udp的辨析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tcp与udp的辨析"}},[v._v("#")]),v._v(" TCP与UDP的辨析")]),v._v(" "),t("p",[v._v("TCP 协议，通过三次握手，建立了稳定的传输通道。因此，TCP 又被称为“"),t("strong",[v._v("面向连接的可靠传输")]),v._v("”。")]),v._v(" "),t("p",[v._v("UDP 则恰恰相反，没有握手、同意与否，直接连接。")]),v._v(" "),t("p",[v._v("在 UDP 协议下，数据想发就发，随时可发。因此，UDP 又被称为是“"),t("strong",[v._v("无连接的不可靠传输")]),v._v("”。")]),v._v(" "),t("h4",{attrs:{id:"udp-的应用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#udp-的应用场景"}},[v._v("#")]),v._v(" UDP 的应用场景")]),v._v(" "),t("p",[v._v("乍一看，UDP这么不可靠，好像没什么存在的意义。")]),v._v(" "),t("p",[v._v("但也有它的过人之处，比如：")]),v._v(" "),t("ul",[t("li",[t("strong",[v._v("面向多方")]),v._v("：支持一对多，多对多，多对一。tcp 只能一对一。")]),v._v(" "),t("li",[t("strong",[v._v("头部开销小")]),v._v("：头部只有 8 个字节，而 TCP 需要 20 个字节。明显效率更高。")]),v._v(" "),t("li",[t("strong",[v._v("随意也是优点")]),v._v("：当连接需要实时建立时，没有反复的握手挥手，反而更灵活")])]),v._v(" "),t("p",[v._v("在一些对实时性要求比较强的场合，比如网络电话、视频会议、在线直播这些地方，UDP 比 TCP 更加合适")])])}),[],!1,null,null,null);_.default=a.exports}}]);