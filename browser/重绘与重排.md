## 重排与重绘

上一节学到，页面要经过 *HTML解析-> css解析 -> 渲染树构建 -> 布局 -> 绘制* 这样漫长的过程才能展现到我们面前。

然而这只是页面第一次绘制。在后续的交互过程中，我们可能会通过CSS、JS来对页面中的元素进行修改，这些会重新触发页面的生命周期。

重走页面生命周期的这个过程，有两种主要的形式 —— **重排与重绘**。

### 什么是重排？

当我们操作 DOM 几何尺寸（比如修改元素的宽、高或隐藏元素等）时，浏览器需要重新计算 DOM 的尺寸和位置然后绘制出来。这个过程就是重排（也叫回流）

一个常见修改宽度的例子：

```javascript
var targetDom = document.getElementById('target');
targetDom.style.width = '200px';
```

因为修改了dom宽度，不仅影响了盒模型本身的“占地面积”、还会整个页面中其它元素的布局形式。浏览器不得不重新针对布局信息进行计算，这就是典型的重排过程。

重排时，生命周期如下：

![F2A50147-AF8B-4DC3-9EC9-153F5CC2AC81](/assets/F2A50147-AF8B-4DC3-9EC9-153F5CC2AC81.png)

#### 还有什么动作会触发重排？

**1. 改变 DOM 树的结构**

主要指的是节点的增减、移动等操作

**2. 获取一些特定属性的值（重要）**

offset相关，scroll相关，client相关

共性：需要通过**即时计算**得到的值都会触发回流

### 什么是重绘？

当我们修改了 DOM 的样式，此时并没有影响到布局，浏览器只需要为该元素绘制新的样式即可，这个过程就叫做重绘。

一个常见修改颜色的例子：

```javascript
var targetDom = document.getElementById('targetText');
targetDom.style.color = 'red';
```

浏览器要想改变文字的颜色，只需要去变更像素点的色值即可，不涉及任何布局计算。因此，这是一个典型的重绘过程。

重绘时，生命周期如下：

![2EF8195A-BFBF-4895-9970-6DA71EFB92B5](/assets/2EF8195A-BFBF-4895-9970-6DA71EFB92B5.png)

### 命题思路点拨

“针对页面渲染流程中的性能优化，你有什么思路？”

这个答案要答到重绘与重排，性能问题大多是重排引起的
